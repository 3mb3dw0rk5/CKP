<html ng-app="keepassApp" ng-csp>
	<head>
		<title>KeePass - Choose password file</title>
		<link rel="stylesheet" href="bootstrap.min.css" />
		<link rel="stylesheet" href="popup.css" />
		<link rel="stylesheet" href="angular-csp.css" />
		<script type="text/javascript" src="/lib/util.js"></script>
		<script type="text/javascript" src="/lib/angular.min.js"></script>
		<script type="text/javascript" src="/lib/gdocs.js"></script>
		<script type="text/javascript" src="/lib/pako.min.js"></script>
		<script type="text/javascript" src="keepassService.js"></script>
		<script type="text/javascript" src="popup.js"></script>
		<script type="text/javascript" src="docsController.js"></script>
		<script type="text/javascript" src="masterPasswordController.js"></script>
	</head>
	<body ng-controller="DocsController">
		<div>
		  Google Docs:
			<button id="authorize-button" class="btn" data-ng-click="toggleAuth(true)">
				{{authButtonLabel()}}
			</button>
			<button class="btn" data-ng-click="fetchDocs(false)">
				Refresh
			</button>
			<h4>Password Files</h4>
			<filelist>
  			<ul>
  				<li data-ng-repeat="doc in docs" ng-class="{selected: doc.selected()}" ng-click="choosePasswordFile(doc.url)">
  					{{doc.title}}
  				</li>
  			</ul>
			</filelist>
		</div>
		<div ng-show="fileName">
			<div ng-controller="MasterPasswordController">
  			<pageInfo ng-show="url || title">{{title}} - {{url}}</pageInfo>
			  <form action="#" name="pwd">
    			<h4>Enter master password</h4>
    			<fieldset>
    				<input type="password" ng-model="masterPassword" ng-keyup="clearMessages()" ng-readonly="busy">
    				<button type="submit" id="submitPassword" class="btn" ng-click="enterMasterPassword()" ng-disabled="busy">
    					Enter
    				</button>
    				<busyMessage data-ng-show="busy">Decrypting...</busyMessage>
    				<errorMessage data-ng-show="errorMessage">{{errorMessage}}</errorMessage>
    				<successMessage data-ng-show="successMessage">{{successMessage}}</successMessage>
    			</fieldset>
				</form>
  			<passwordMatches ng-show="entries">
  			  <ul>
  			    <li ng-repeat="entry in entries">
  			      {{entry.Title.value}} - {{entry.UserName.value}}
  			    </li>
  			  </ul>
  			</passwordMatches>
			</div>
		</div>
	</body>
</html>